<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Interactive Quiz Platform</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    :root {
      --primary-color: #4e73df;
      --primary-hover: #2e59d9;
      --success-color: #28a745;
      --danger-color: #dc3545;
      --warning-color: #ffc107;
    }
    
    body {
      background-color: #f8f9fa;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      min-height: 100vh;
    }
    
    .card {
      transition: transform 0.3s, box-shadow 0.3s;
      border: none;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      height: 100%;
    }
    
    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
    }
    
    .card-img-top {
      height: 180px;
      object-fit: cover;
    }
    
    .btn-primary {
      background-color: var(--primary-color);
      border-color: var(--primary-color);
      font-weight: 500;
    }
    
    .btn-primary:hover {
      background-color: var(--primary-hover);
      border-color: var(--primary-hover);
    }
    
    .quiz-container {
      max-width: 800px;
      margin: 0 auto;
      background: white;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
    }
    
    .option {
      text-align: left;
      margin-bottom: 10px;
      transition: all 0.3s;
      padding: 12px 15px;
      border-radius: 8px;
      cursor: pointer;
      border: 1px solid #dee2e6;
    }
    
    .option:hover:not(.selected) {
      background-color: #f8f9fa;
      border-color: var(--primary-color);
    }
    
    .selected {
      background-color: var(--primary-color);
      color: white;
      border-color: var(--primary-color);
    }
    
    .correct {
      background-color: var(--success-color);
      color: white;
      border-color: var(--success-color);
    }
    
    .incorrect {
      background-color: var(--danger-color);
      color: white;
      border-color: var(--danger-color);
    }
    
    .progress {
      height: 10px;
      margin-bottom: 20px;
      border-radius: 5px;
    }
    
    #loading {
      display: none;
      text-align: center;
      margin: 20px 0;
    }
    
    .difficulty-badge {
      font-size: 0.8rem;
      padding: 3px 8px;
      border-radius: 10px;
      font-weight: 500;
    }
    
    .easy {
      background-color: var(--success-color);
      color: white;
    }
    
    .medium {
      background-color: var(--warning-color);
      color: black;
    }
    
    .hard {
      background-color: var(--danger-color);
      color: white;
    }
    
    .quiz-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    
    .timer {
      background-color: #f8f9fa;
      padding: 5px 10px;
      border-radius: 20px;
      font-weight: bold;
    }
    
    .result-card {
      text-align: center;
      padding: 30px;
    }
    
    .result-icon {
      font-size: 4rem;
      margin-bottom: 20px;
    }
    
    .score-display {
      font-size: 3rem;
      font-weight: bold;
      margin: 20px 0;
      color: var(--primary-color);
    }
    
    .performance-message {
      font-size: 1.2rem;
      margin-bottom: 20px;
    }
    
    .question-count-selector {
      margin: 20px 0;
      padding: 15px;
      background: #f8f9fa;
      border-radius: 10px;
    }
    
    .question-count-options {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-top: 10px;
    }
    
    .question-count-btn {
      flex: 1;
      min-width: 60px;
    }
    
    #next-question {
      display: none;
    }
    
    @media (max-width: 768px) {
      .card-img-top {
        height: 120px;
      }
      
      .quiz-container {
        padding: 20px;
      }
      
      .option {
        padding: 10px 12px;
      }
    }
  </style>
</head>
<body>
  <div class="container py-5">
    <!-- Loading Indicator -->
    <div id="loading">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
      <p class="mt-2">Loading quiz data...</p>
    </div>

    <!-- Topic Selection -->
    <div id="topic-selection" class="text-center">
      <h1 class="mb-4">Welcome to QuizMaster</h1>
      <p class="lead mb-5">Select a topic to begin your quiz</p>
      <div class="row g-4" id="topics-container"></div>
    </div>
    
    <!-- Subtopic Selection -->
    <div id="subtopic-selection" class="text-center d-none">
      <h2 id="subtopic-heading" class="mb-4">Select a Subtopic</h2>
      <button class="btn btn-outline-secondary mb-4" id="back-to-topics">
        <i class="bi bi-arrow-left"></i> Back to Topics
      </button>
      <div class="row g-4" id="subtopics-container"></div>
    </div>
    
    <!-- Question Count Selection -->
    <div id="question-count-selection" class="text-center d-none">
      <h2 id="question-count-heading" class="mb-4">Select Number of Questions</h2>
      <button class="btn btn-outline-secondary mb-4" id="back-to-subtopics-from-count">
        <i class="bi bi-arrow-left"></i> Back to Subtopics
      </button>
      <div class="question-count-selector">
        <p>How many questions would you like in your quiz?</p>
        <div class="question-count-options" id="question-count-options"></div>
      </div>
    </div>
    
    <!-- Quiz Area -->
    <div id="quiz-area" class="d-none">
      <div class="quiz-container">
        <div class="quiz-header">
          <button class="btn btn-outline-secondary" id="back-to-count-selection">
            <i class="bi bi-arrow-left"></i> Back
          </button>
          <div class="timer" id="quiz-timer">00:00</div>
        </div>
        
        <div class="progress">
          <div id="quiz-progress" class="progress-bar" role="progressbar"></div>
        </div>
        
        <div id="question-container" class="mb-4"></div>
        <div id="options-container" class="my-4"></div>
        
        <div class="d-flex justify-content-between align-items-center">
          <div id="question-counter" class="text-muted"></div>
          <button id="submit-answer" class="btn btn-primary">Submit Answer</button>
        </div>
        
        <div id="feedback-container" class="mt-4"></div>
        <div id="score-container" class="mt-3 fw-bold"></div>
        <button id="next-question" class="btn btn-primary mt-3 w-100">
          <i class="bi bi-arrow-right"></i> Next Question
        </button>
      </div>
    </div>
  </div>

  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.0/font/bootstrap-icons.css">
  
  <script>
    // Configuration
    const config = {
      googleSheetUrl: "https://docs.google.com/spreadsheets/d/e/2PACX-1vSHZc4XKsA7NeFUs9YppeBSchqG01tWIzVrCnvbydr1t-qqUnd8RlOe-EypAn8m4trcvaQ0OR-4WzEN/pub?output=csv",
      corsProxyUrl: "https://api.allorigins.win/raw?url=",
      fallbackData: `Topics,Subtopics,Question,OptionA,OptionB,OptionC,OptionD,CorrectAnswer,Explanation
Science,Physics,What is Newton's First Law?,An object at rest stays at rest,An object in motion stays in motion,For every action there is an equal reaction,Energy cannot be created or destroyed,A,Newton's First Law is also called the Law of Inertia
History,India,When did India gain independence?,1945,1947,1950,1935,B,India gained independence from British rule on August 15, 1947
Maths,Algebra,What is 2+2?,3,4,5,6,B,Basic arithmetic sum`,
      questionCountOptions: [5, 10, 15, 20]
    };

    // DOM Elements
    const topicSelection = document.getElementById('topic-selection');
    const subtopicSelection = document.getElementById('subtopic-selection');
    const questionCountSelection = document.getElementById('question-count-selection');
    const quizArea = document.getElementById('quiz-area');
    const topicsContainer = document.getElementById('topics-container');
    const subtopicsContainer = document.getElementById('subtopics-container');
    const questionCountOptions = document.getElementById('question-count-options');
    const questionContainer = document.getElementById('question-container');
    const optionsContainer = document.getElementById('options-container');
    const feedbackContainer = document.getElementById('feedback-container');
    const scoreContainer = document.getElementById('score-container');
    const loadingIndicator = document.getElementById('loading');
    const subtopicHeading = document.getElementById('subtopic-heading');
    const questionCountHeading = document.getElementById('question-count-heading');
    const quizTimer = document.getElementById('quiz-timer');
    const submitAnswerBtn = document.getElementById('submit-answer');
    const nextQuestionBtn = document.getElementById('next-question');

    // State
    let quizData = [];
    let currentTopic = null;
    let currentSubtopic = null;
    let currentTopicName = '';
    let selectedQuestionCount = 10;
    let availableQuestions = [];
    let quizQuestions = [];
    let currentQuestionIndex = 0;
    let score = 0;
    let selectedOption = null;
    let timerInterval = null;
    let secondsElapsed = 0;
    let quizStartTime = null;

    // Initialize
    document.addEventListener('DOMContentLoaded', async () => {
      await loadQuizData();
      
      // Navigation handlers
      document.getElementById('back-to-topics').addEventListener('click', () => {
        subtopicSelection.classList.add('d-none');
        topicSelection.classList.remove('d-none');
        resetQuizState();
      });
      
      document.getElementById('back-to-subtopics-from-count').addEventListener('click', () => {
        questionCountSelection.classList.add('d-none');
        subtopicSelection.classList.remove('d-none');
      });
      
      document.getElementById('back-to-count-selection').addEventListener('click', () => {
        quizArea.classList.add('d-none');
        questionCountSelection.classList.remove('d-none');
        resetQuizState();
      });
      
      submitAnswerBtn.addEventListener('click', checkAnswer);
      nextQuestionBtn.addEventListener('click', nextQuestion);
    });

    async function loadQuizData() {
      showLoading();
      
      try {
        // Try loading from Google Sheets via CORS proxy
        const response = await fetch(`${config.corsProxyUrl}${encodeURIComponent(config.googleSheetUrl)}`);
        
        if (!response.ok) throw new Error('Network response was not ok');
        
        const csv = await response.text();
        processQuizData(csv);
      } catch (error) {
        console.error("Failed to load from Google Sheets:", error);
        
        // Fallback to local data
        try {
          processQuizData(config.fallbackData);
          showMessage("Using sample data (couldn't connect to server)", 'warning');
        } catch (fallbackError) {
          console.error("Failed to process fallback data:", fallbackError);
          showMessage("Failed to load quiz data. Please check your connection.", 'danger');
        }
      } finally {
        hideLoading();
      }
    }

    function processQuizData(csv) {
      const rows = parseCSV(csv);
      const headers = rows[0].map(header => header.trim().toLowerCase());
      
      // Verify required columns exist
      const requiredColumns = ['topics', 'subtopics', 'question', 'optiona', 'optionb', 'optionc', 'optiond', 'correctanswer'];
      requiredColumns.forEach(col => {
        if (!headers.includes(col)) {
          throw new Error(`Missing required column: ${col}`);
        }
      });
      
      quizData = rows.slice(1)
        .map(row => {
          const question = {};
          headers.forEach((header, index) => {
            question[header] = (row[index] || '').trim();
          });
          // Convert correct answer to uppercase for consistency
          if (question.correctanswer) {
            question.correctanswer = question.correctanswer.toUpperCase();
          }
          return question;
        })
        .filter(q => q.topics && q.subtopics && q.question);
      
      if (quizData.length === 0) {
        throw new Error('No valid questions found in the data');
      }
      
      populateTopics();
      setupQuestionCountOptions();
    }

    function parseCSV(csv) {
      const rows = [];
      let currentRow = [];
      let currentValue = '';
      let inQuotes = false;
      
      for (let i = 0; i < csv.length; i++) {
        const char = csv[i];
        
        if (char === '"') {
          inQuotes = !inQuotes;
        } else if (char === ',' && !inQuotes) {
          currentRow.push(currentValue);
          currentValue = '';
        } else if (char === '\n' && !inQuotes) {
          currentRow.push(currentValue);
          rows.push(currentRow);
          currentRow = [];
          currentValue = '';
        } else {
          currentValue += char;
        }
      }
      
      // Add the last row
      if (currentValue || currentRow.length) {
        currentRow.push(currentValue);
        rows.push(currentRow);
      }
      
      return rows;
    }

    function populateTopics() {
      // Get unique topics
      const topics = [...new Set(quizData.map(q => q.topics))].sort();
      
      if (!topics || topics.length === 0) {
        topicsContainer.innerHTML = `
          <div class="col-12">
            <div class="alert alert-danger">No topics found in the quiz data.</div>
          </div>
        `;
        return;
      }
      
      topicsContainer.innerHTML = '';
      
      topics.forEach(topic => {
        // Find first question with this topic to get sample data
        const sampleQuestion = quizData.find(q => q.topics === topic);
        const subtopics = [...new Set(
          quizData.filter(q => q.topics === topic).map(q => q.subtopics)
        )];
        
        const topicCard = document.createElement('div');
        topicCard.className = 'col-md-4 col-sm-6';
        topicCard.innerHTML = `
          <div class="card h-100">
            <img src="https://via.placeholder.com/300x150?text=${encodeURIComponent(topic)}" class="card-img-top" alt="${topic}">
            <div class="card-body d-flex flex-column">
              <h5 class="card-title">${topic}</h5>
              <p class="card-text">${subtopics.length} subtopics available</p>
              <button class="btn btn-primary select-topic mt-auto" data-topic="${topic}">
                Select Topic <i class="bi bi-arrow-right"></i>
              </button>
            </div>
          </div>
        `;
        topicsContainer.appendChild(topicCard);
      });
      
      document.querySelectorAll('.select-topic').forEach(button => {
        button.addEventListener('click', async (e) => {
          currentTopic = e.target.getAttribute('data-topic');
          currentTopicName = currentTopic;
          await loadSubtopics(currentTopic);
          topicSelection.classList.add('d-none');
          subtopicSelection.classList.remove('d-none');
          subtopicHeading.textContent = `${currentTopicName} - Select Subtopic`;
        });
      });
    }

    function setupQuestionCountOptions() {
      questionCountOptions.innerHTML = '';
      
      config.questionCountOptions.forEach(count => {
        const btn = document.createElement('button');
        btn.className = 'btn btn-outline-primary question-count-btn';
        btn.textContent = count;
        btn.dataset.count = count;
        questionCountOptions.appendChild(btn);
      });
      
      document.querySelectorAll('.question-count-btn').forEach(btn => {
        btn.addEventListener('click', (e) => {
          selectedQuestionCount = parseInt(e.target.dataset.count);
          prepareQuizQuestions();
          questionCountSelection.classList.add('d-none');
          quizArea.classList.remove('d-none');
          startQuiz();
        });
      });
    }

    async function loadSubtopics(topic) {
      showLoading();
      
      // Get unique subtopics for this topic
      const subtopics = [...new Set(
        quizData.filter(q => q.topics === topic).map(q => q.subtopics)
      )].sort();
      
      hideLoading();
      
      if (!subtopics || subtopics.length === 0) {
        subtopicsContainer.innerHTML = `
          <div class="col-12">
            <div class="alert alert-warning">No subtopics found for this topic.</div>
          </div>
        `;
        return;
      }
      
      subtopicsContainer.innerHTML = '';
      
      subtopics.forEach(subtopic => {
        // Count questions in this subtopic
        const questionCount = quizData.filter(q => 
          q.topics === topic && q.subtopics === subtopic
        ).length;
        
        const subtopicCard = document.createElement('div');
        subtopicCard.className = 'col-md-6';
        subtopicCard.innerHTML = `
          <div class="card h-100">
            <div class="card-body d-flex flex-column">
              <h5 class="card-title">${subtopic}</h5>
              <p class="card-text">${questionCount} questions available</p>
              <div class="mt-auto">
                <button class="btn btn-primary mt-3 w-100 select-subtopic" data-topic="${topic}" data-subtopic="${subtopic}">
                  Start Quiz <i class="bi bi-play-fill"></i>
                </button>
              </div>
            </div>
          </div>
        `;
        subtopicsContainer.appendChild(subtopicCard);
      });
      
      document.querySelectorAll('.select-subtopic').forEach(button => {
        button.addEventListener('click', async (e) => {
          currentTopic = e.target.getAttribute('data-topic');
          currentSubtopic = e.target.getAttribute('data-subtopic');
          await loadQuestions(currentTopic, currentSubtopic);
          subtopicSelection.classList.add('d-none');
          questionCountSelection.classList.remove('d-none');
          questionCountHeading.textContent = `${currentTopicName} - ${currentSubtopic} - Select Question Count`;
        });
      });
    }

    async function loadQuestions(topic, subtopic) {
      showLoading();
      
      availableQuestions = quizData.filter(q => 
        q.topics === topic && 
        q.subtopics === subtopic
      );
      
      hideLoading();
      
      if (!availableQuestions || availableQuestions.length === 0) {
        questionContainer.innerHTML = `
          <div class="alert alert-danger">No questions found for this subtopic.</div>
        `;
        return;
      }
    }

    function prepareQuizQuestions() {
      // Shuffle available questions and select the requested count
      const shuffledQuestions = shuffleArray([...availableQuestions]);
      quizQuestions = shuffledQuestions.slice(0, Math.min(selectedQuestionCount, shuffledQuestions.length));
      
      currentQuestionIndex = 0;
      score = 0;
      secondsElapsed = 0;
    }

    function startQuiz() {
      quizStartTime = new Date();
      startTimer();
      displayQuestion();
    }

    function startTimer() {
      if (timerInterval) clearInterval(timerInterval);
      
      timerInterval = setInterval(() => {
        secondsElapsed++;
        const minutes = Math.floor(secondsElapsed / 60);
        const seconds = secondsElapsed % 60;
        quizTimer.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
      }, 1000);
    }

    function displayQuestion() {
      // Hide next question button at start of new question
      nextQuestionBtn.style.display = 'none';
      submitAnswerBtn.style.display = 'block';
      
      if (currentQuestionIndex >= quizQuestions.length) {
        endQuiz();
        return;
      }
      
      const question = quizQuestions[currentQuestionIndex];
      
      // Update progress bar
      const progressPercent = (currentQuestionIndex / quizQuestions.length) * 100;
      document.getElementById('quiz-progress').style.width = `${progressPercent}%`;
      document.getElementById('question-counter').textContent = `Question ${currentQuestionIndex + 1} of ${quizQuestions.length}`;
      
      questionContainer.innerHTML = `
        <div class="card">
          <div class="card-body">
            <h3 class="card-title">${question.question}</h3>
          </div>
        </div>
      `;
      
      optionsContainer.innerHTML = '';
      feedbackContainer.innerHTML = '';
      scoreContainer.innerHTML = `Current Score: ${score}/${quizQuestions.length}`;
      submitAnswerBtn.disabled = true;
      selectedOption = null;
      
      // Create options
      const options = [
        { text: question.optiona, value: 'A' },
        { text: question.optionb, value: 'B' },
        { text: question.optionc, value: 'C' },
        { text: question.optiond, value: 'D' }
      ];
      
      options.forEach((option) => {
        if (option.text) { // Only show if option exists
          const optionElement = document.createElement('div');
          optionElement.className = 'option';
          optionElement.textContent = option.text;
          optionElement.dataset.value = option.value;
          optionElement.addEventListener('click', selectOption);
          optionsContainer.appendChild(optionElement);
        }
      });
    }

    function selectOption(e) {
      // Remove selected class from all options
      document.querySelectorAll('.option').forEach(opt => {
        opt.classList.remove('selected');
      });
      
      // Add selected class to clicked option
      e.target.classList.add('selected');
      submitAnswerBtn.disabled = false;
      selectedOption = e.target.dataset.value;
    }

    function checkAnswer() {
      if (selectedOption === null) {
        feedbackContainer.innerHTML = '<div class="alert alert-warning">Please select an answer before submitting.</div>';
        return;
      }
      
      const question = quizQuestions[currentQuestionIndex];
      const correctAnswer = question.correctanswer;
      const explanation = question.explanation || 'No explanation available';
      
      // Disable all options
      document.querySelectorAll('.option').forEach(opt => {
        opt.style.pointerEvents = 'none';
        
        // Highlight correct and incorrect answers
        if (opt.dataset.value === correctAnswer) {
          opt.classList.add('correct');
        } else if (opt.dataset.value === selectedOption) {
          opt.classList.add('incorrect');
        }
      });
      
      if (selectedOption === correctAnswer) {
        score++;
        feedbackContainer.innerHTML = `
          <div class="alert alert-success">
            <i class="bi bi-check-circle-fill"></i> <strong>Correct!</strong> Well done.
          </div>
        `;
      } else {
        feedbackContainer.innerHTML = `
          <div class="alert alert-danger">
            <i class="bi bi-x-circle-fill"></i> <strong>Incorrect.</strong> The correct answer was: ${question['option' + correctAnswer.toLowerCase()]}
          </div>
          <div class="alert alert-info">
            <i class="bi bi-info-circle-fill"></i> ${explanation}
          </div>
        `;
      }
      
      scoreContainer.innerHTML = `Current Score: ${score}/${quizQuestions.length}`;
      submitAnswerBtn.disabled = true;
      
      // Hide submit button and show next question button
      submitAnswerBtn.style.display = 'none';
      nextQuestionBtn.style.display = 'block';
    }

    function nextQuestion() {
      currentQuestionIndex++;
      displayQuestion();
    }

    function endQuiz() {
      clearInterval(timerInterval);
      
      const percentage = score / quizQuestions.length;
      const resultMessage = getPerformanceMessage(percentage);
      const timeSpent = formatTime(secondsElapsed);
      
      questionContainer.innerHTML = `
        <div class="card result-card">
          <i class="bi bi-trophy-fill result-icon text-warning"></i>
          <h2>Quiz Completed!</h2>
          <div class="score-display">${score}/${quizQuestions.length}</div>
          <div class="performance-message">${resultMessage}</div>
          <p>Time spent: ${timeSpent}</p>
          <button id="restart-quiz" class="btn btn-primary">
            <i class="bi bi-arrow-repeat"></i> Try Again
          </button>
          <button id="new-quiz" class="btn btn-outline-primary mt-2">
            <i class="bi bi-list-ul"></i> Choose Different Quiz
          </button>
        </div>
      `;
      
      optionsContainer.innerHTML = '';
      feedbackContainer.innerHTML = '';
      submitAnswerBtn.style.display = 'none';
      nextQuestionBtn.style.display = 'none';
      
      document.getElementById('restart-quiz').addEventListener('click', () => {
        prepareQuizQuestions();
        quizArea.classList.remove('d-none');
        startQuiz();
        submitAnswerBtn.style.display = 'block';
      });
      
      document.getElementById('new-quiz').addEventListener('click', () => {
        quizArea.classList.add('d-none');
        questionCountSelection.classList.remove('d-none');
        resetQuizState();
      });
    }

    function formatTime(seconds) {
      const minutes = Math.floor(seconds / 60);
      const remainingSeconds = seconds % 60;
      return `${minutes}m ${remainingSeconds}s`;
    }

    function getPerformanceMessage(percentage) {
      if (percentage >= 0.9) return "Excellent work! You've mastered this topic.";
      if (percentage >= 0.7) return "Good job! You have a solid understanding.";
      if (percentage >= 0.5) return "Not bad! Consider reviewing some areas.";
      return "Keep practicing! You'll improve with more study.";
    }

    function resetQuizState() {
      currentQuestionIndex = 0;
      score = 0;
      selectedOption = null;
      secondsElapsed = 0;
      clearInterval(timerInterval);
      quizTimer.textContent = '00:00';
      submitAnswerBtn.style.display = 'block';
      nextQuestionBtn.style.display = 'none';
    }

    function showLoading() {
      loadingIndicator.style.display = 'block';
    }

    function hideLoading() {
      loadingIndicator.style.display = 'none';
    }

    function showMessage(message, type = 'info') {
      const alert = document.createElement('div');
      alert.className = `alert alert-${type} mt-3`;
      alert.textContent = message;
      document.body.prepend(alert);
      
      setTimeout(() => {
        alert.remove();
      }, 5000);
    }

    // Fisher-Yates shuffle algorithm
    function shuffleArray(array) {
      const newArray = [...array];
      for (let i = newArray.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
      }
      return newArray;
    }
  </script>
</body>
</html>
