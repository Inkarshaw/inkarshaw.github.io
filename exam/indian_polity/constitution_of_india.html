<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Indian Polity – Constitution of India Quiz</title>

<style>
body{font-family:Arial,sans-serif;background:#f5f7fb;margin:0}
header{background:#1e40af;color:#fff;padding:15px;text-align:center}
.container{max-width:1000px;margin:auto;padding:15px}
.box{background:#fff;padding:20px;border-radius:10px;margin-bottom:15px}
.options label{display:block;background:#f1f5f9;padding:10px;margin:8px 0;border-radius:6px}
button{padding:8px 15px;border:none;border-radius:20px;font-size:14px;cursor:pointer}
.start{background:#16a34a;color:#fff}
.next{background:#2563eb;color:#fff}
.submit{background:#dc2626;color:#fff;margin-left:10px}
.correct{color:green;font-weight:bold}
.wrong{color:red;font-weight:bold}
.timer{font-weight:bold;color:#dc2626;margin-bottom:10px}

/* Breadcrumb */
.breadcrumb{
  font-size:14px;
  margin-bottom:10px;
}
.breadcrumb a{
  color:#2563eb;
  text-decoration:none;
}
.breadcrumb span{color:#555}

/* Palette */
.palette{
  display:grid;
  grid-template-columns:repeat(auto-fill,40px);
  gap:6px;
  margin-bottom:15px;
}
.palette div{
  padding:8px;
  text-align:center;
  border-radius:6px;
  cursor:pointer;
  background:#e5e7eb;
}
.palette .visited{background:#93c5fd}
.palette .answered{background:#86efac}
</style>
</head>

<body>

<header>
  <h2>Exam Practice Quiz</h2>
</header>

<div class="container">

<!-- BREADCRUMB -->
<div class="breadcrumb">
  <a href="https://www.clearexams.online">Home</a> &gt;
  <a href="https://www.clearexams.online/exam/indian_polity.html">Indian Polity</a> &gt;
  <a href="https://www.clearexams.online/exam/indian_polity/constitution_of_india.html">Constitution of India</a> &gt;
  <span>Quiz</span>
</div>

<!-- SETTINGS -->
<div class="box" id="settingsBox">
  <h3>Quiz Settings</h3>

  No. of Questions<br>
  <select id="questionCount">
    <option value="5">5</option>
    <option value="10" selected>10</option>
    <option value="20">20</option>
    <option value="all">All</option>
  </select><br><br>

  Question Range<br>
  From <input type="number" id="rangeFrom" style="width:60px">
  To <input type="number" id="rangeTo" style="width:60px">
  <p id="rangeInfo" style="font-size:13px;color:#555"></p>

  <label>
    <input type="checkbox" id="randomize"> Random Questions
  </label><br><br>

  Time (minutes)<br>
  <input type="number" id="timeLimit" value="10" style="width:60px"><br><br>

  <button class="start" onclick="startQuiz()">Start Quiz</button>
</div>

<!-- QUIZ -->
<div class="box" id="quizBox" style="display:none">
  <div class="timer" id="timer"></div>
  <div class="palette" id="palette"></div>

  <div id="question"></div>
  <div class="options" id="options"></div>

  <button class="next" onclick="nextQ()">Next</button>
  <button class="submit" onclick="confirmSubmit()">Submit Quiz</button>
</div>

<!-- REVIEW -->
<div id="reviewBox"></div>

</div>

<script>
const sheetURL =
"https://docs.google.com/spreadsheets/d/e/2PACX-1vRhUA51WgTVQ7AnW8O136gYvtB_zKhPAyJU6vtR2-mghYEB0pPSZIqUT9q_kuDZSRrZENs1BfQAwDIf/pub?output=csv";

let allQuestions=[], quiz=[], index=0, userAnswers=[];
let timerInterval, timeLeft;

// LOAD QUESTIONS
fetch(sheetURL).then(r=>r.text()).then(t=>{
  const rows=t.trim().split("\n").slice(1);
  allQuestions=rows.map(r=>{
    const c=r.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);
    return {
      q:c[0],
      opts:c.slice(1,5),
      ans:c[5].trim().toUpperCase(), // A/B/C/D
      exp:c[6]
    };
  });

  const total=allQuestions.length;
  rangeFrom.max=rangeTo.max=total;
  rangeFrom.value=1;
  rangeTo.value=total;
  rangeInfo.innerText=`Available questions: 1 to ${total}`;
});

// START QUIZ
function startQuiz(){
  let count=questionCount.value;
  let from=parseInt(rangeFrom.value);
  let to=parseInt(rangeTo.value);
  let random=randomize.checked;
  let minutes=parseInt(timeLimit.value)||10;

  quiz=[...allQuestions].slice(from-1,to);
  if(random) quiz.sort(()=>Math.random()-0.5);
  if(count!=="all") quiz=quiz.slice(0,parseInt(count));

  index=0;
  userAnswers=new Array(quiz.length).fill(null);

  settingsBox.style.display="none";
  quizBox.style.display="block";

  createPalette();
  startTimer(minutes*60);
  loadQ();
}

// TIMER
function startTimer(sec){
  timeLeft=sec;
  timerInterval=setInterval(()=>{
    let m=Math.floor(timeLeft/60);
    let s=timeLeft%60;
    timer.innerText=`Time Left: ${m}:${s.toString().padStart(2,"0")}`;
    if(timeLeft--<=0){
      clearInterval(timerInterval);
      alert("Time Over! Quiz will be submitted.");
      submitQuiz();
    }
  },1000);
}

// PALETTE
function createPalette(){
  palette.innerHTML="";
  quiz.forEach((_,i)=>{
    const d=document.createElement("div");
    d.innerText=i+1;
    d.onclick=()=>jumpQ(i);
    palette.appendChild(d);
  });
}
function updatePalette(){
  document.querySelectorAll(".palette div").forEach((d,i)=>{
    d.className="";
    if(userAnswers[i]) d.classList.add("answered");
    else if(i<=index) d.classList.add("visited");
  });
}

// LOAD QUESTION
function loadQ(){
  const q=quiz[index];
  question.innerHTML=`<h3>Q${index+1}. ${q.q}</h3>`;
  options.innerHTML="";
  q.opts.forEach((opt,i)=>{
    const letter=String.fromCharCode(65+i);
    options.innerHTML+=`
      <label>
        <input type="radio" name="opt" value="${letter}"
        ${userAnswers[index]==letter?"checked":""}>
        <b>${letter}.</b> ${opt}
      </label>`;
  });
  updatePalette();
}

// NAVIGATION
function saveAnswer(){
  const sel=document.querySelector('input[name="opt"]:checked');
  userAnswers[index]=sel?sel.value:null;
}
function nextQ(){saveAnswer();if(index<quiz.length-1){index++;loadQ();}}
function jumpQ(i){saveAnswer();index=i;loadQ();}

// SUBMIT CONFIRMATION
function confirmSubmit(){
  saveAnswer();
  if(confirm("⚠️ Are you sure you want to submit the quiz?\nYou cannot change answers after submission.")){
    submitQuiz();
  }
}

// SUBMIT
function submitQuiz(){
  clearInterval(timerInterval);
  quizBox.style.display="none";
  showReview();
}

// REVIEW (ATTEMPTED ONLY)
function showReview(){
  let score=0,attempted=0;
  let html=`<div class="box"><h2>Quiz Review</h2>`;
  quiz.forEach((q,i)=>{
    if(!userAnswers[i]) return;
    attempted++;
    const right=userAnswers[i]===q.ans;
    if(right) score++;
    const uaIndex=userAnswers[i].charCodeAt(0)-65;
    const caIndex=q.ans.charCodeAt(0)-65;

    html+=`
      <hr>
      <p><b>Q${i+1}. ${q.q}</b></p>
      <p>Your Answer: <b>${userAnswers[i]}</b>. ${q.opts[uaIndex]}</p>
      <p>Correct Answer: <b>${q.ans}</b>. ${q.opts[caIndex]}</p>
      <p class="${right?'correct':'wrong'}">${right?'✔ Correct':'✖ Wrong'}</p>
      <p><b>Explanation:</b> ${q.exp}</p>
    `;
  });

  html+=`
    <h3>Attempted: ${attempted}/${quiz.length}</h3>
    <h3>Score: ${score}/${attempted}</h3>
  </div>`;

  reviewBox.innerHTML=html;
}
</script>

</body>
</html>
